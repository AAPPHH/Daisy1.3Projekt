import numpy as np

class Game:
    def __init__(self, m=5, n=5):
        self.m = m
        self.n = n
        self.board = np.zeros((m, n), dtype=int)
        self.current_player = 1

    def print_board(self):
        for row in self.board:
            print(' '.join(str(int(val)) for val in row))

    def place_piece(self, row, col):
        if self.is_valid_move(row, col):
            self.board[row][col] = self.current_player
            return True
        return False

    def is_valid_move(self, row, col):
        if 0 <= row < self.m and 0 <= col < self.n and self.board[row][col] == 0:
            return True
        return False

    def is_winner(self):
        piece = self.current_player
        if np.any(np.all(self.board == piece, axis=1)):
            return True
        if np.any(np.all(self.board == piece, axis=0)):
            return True
        if np.all(np.diag(self.board) == piece):
            return True
        if np.all(np.diag(np.fliplr(self.board)) == piece):
            return True
        return False

    def is_full(self):
        return np.all(self.board != 0)

    def switch_player(self):
        self.current_player = 2 if self.current_player == 1 else 1

    def game_loop(self):
        game_over = False
        while not game_over:
            self.print_board()
            try:
                row = int(input(f"Spieler {self.current_player}, geben Sie die Zeilennummer ein (0-{self.m-1}): "))
                col = int(input(f"Spieler {self.current_player}, geben Sie die Spaltennummer ein (0-{self.n-1}): "))
            except ValueError:
                print("Bitte geben Sie gültige ganze Zahlen ein.")
                continue

            if self.place_piece(row, col):
                if self.is_winner():
                    game_over = True
                    self.print_board()
                    print(f"Spieler {self.current_player} hat gewonnen!")
                elif self.is_full():
                    game_over = True
                    self.print_board()
                    print("Das Spiel endet unentschieden!")
                else:
                    self.switch_player()
            else:
                print("Ungültiger Zug, bitte versuchen Sie es erneut.")

# Spielstart
if __name__ == "__main__":
    spiel = Game()
    spiel.game_loop()
